<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta name="robots" content="noindex, nofollow" />

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Host and Service Certificates - OSG ITB Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/itb.css" rel="stylesheet">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Host and Service Certificates";
    var mkdocs_page_input_path = "security/host-certs.md";
    var mkdocs_page_url = "/security/host-certs/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OSG ITB Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
  
    <a class="" href="../..">Home</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  
    <a class="" href="../../site-planning/">Site Planning</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Compute Element</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../compute-element/htcondor-ce-overview/">HTCondor-CE Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../compute-element/install-htcondor-ce/">Install HTCondor-CE</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../compute-element/job-router-recipes/">Job Router Recipes</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../compute-element/troubleshoot-htcondor-ce/">Troubleshooting HTCondor-CE</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../compute-element/submit-htcondor-ce/">Submitting to HTCondor-CE</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Worker Node</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../worker-node/using-wn/">Worker Node Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-wn/">Worker Node via RPM</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-wn-tarball/">Worker Node via Tarball</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-wn-oasis/">Worker Node via OASIS</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-cvmfs/">CVMFS</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-singularity/">Singularity</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Data - HTTP & CVMFS</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../data/frontier-squid/">Install HTTP Cache</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/update-oasis/">Update OASIS Shared Repo</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/external-oasis-repos/">Install an OASIS Repo</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Data - POSIX Storage</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../data/gridftp/">Install GridFTP Server</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/load-balanced-gridftp/">Install Load Balanced GridFTP</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Data - HDFS</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../data/hadoop-overview/">HDFS Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-hadoop-2-0-0/">Install HDFS</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Data - XRootD</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../data/xrootd-overview/">XRootD Overview</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-xrootd/">Install XRootD</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-xroot-client/">Install XRootD Client</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Security</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../lcmaps-voms-authentication/">LCMAPS-VOMS authentication</a>
  
        </li>
        <li class=" current">
          
  
    <a class="current" href="./">Host and Service Certificates</a>
  
  <ul class="subnav">
      
    <li class="toctree-l3"><a href="#host-and-service-certificates">Host and Service Certificates</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#before-starting">Before Starting</a></li>
        
            <li><a class="toctree-l4" href="#requesting-hostservice-certificates-using-the-command-line">Requesting Host/Service Certificates Using the Command Line</a></li>
        
            <li><a class="toctree-l4" href="#requesting-hostservice-certificate-using-oim">Requesting Host/Service Certificate Using OIM</a></li>
        
            <li><a class="toctree-l4" href="#frequently-asked-questions">Frequently Asked Questions</a></li>
        
            <li><a class="toctree-l4" href="#references">References</a></li>
        
        </ul>
    

  </ul>
        </li>
        <li class="">
          
  
    <a class="" href="../user-certs/">User Certificates</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../certificate-management/">Certificate Management Reference</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Common</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../common/install-best-practices/">Install Best Practices</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../common/ca/">CA Certificates</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../common/yum/">Yum Repos</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../common/openjdk7/">Java 7</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/configuration-with-osg-configure/">Configuration with OSG-Configure</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Other</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../other/gsissh/">GSI-enabled SSH</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-gwms-frontend/">GlideinWMS Frontend</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-cvmfs-stratum1/">Install a CVMFS Stratum 1</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/network-performance-toolkit/">Network Performance Toolkit</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/troubleshooting-gratia/">Troubleshooting Gratia</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/schedd-filebeats/">Transfer log filebeats installation</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Release Information</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../release/notes/">Release Notes</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/release_series/">OSG Release Series</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/supported_platforms/">Supported Platforms</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-osg-upcoming-software/">OSG upcoming software</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/yum-basics/">Yum Basics</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/signing/">RPM Signing</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../release/contrib/">Contrib Software</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Monitoring</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../monitoring/install-rsv/">Install RSV</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../monitoring/advanced-rsv-configuration/">Advanced RSV Configuration</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../monitoring/rsv-control/">Manage RSV via rsv-control</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../monitoring/install-rsv-gwms-tester/">RSV GlideinWMS Tester</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  <span class="caption-text">Deprecated Software</span>
  <ul class="subnav">
        <li class="">
          
  
    <a class="" href="../../data/bestman-install/">BeStMan Install</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../data/install-bestman-xrootd/">BeStMan Xrootd SE</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../edg-mkgridmap/">EDG-Mkgridmap Install</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../install-gums/">GUMS</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../worker-node/install-glexec/">Worker node glexec Install</a>
  
        </li>
        <li class="">
          
  
    <a class="" href="../../other/install-voms/">Install VOMS</a>
  
        </li>
  </ul>
	    </li>
          
            <li class="toctree-l1">
		
  
    <a class="" href="../../common/help/">Get Help</a>
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
            <li class="toctree-l1">
		
  
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OSG ITB Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Security &raquo;</li>
        
      
    
    <li>Host and Service Certificates</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/opensciencegrid/docs-itb/edit/master/docs/security/host-certs.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="host-and-service-certificates">Host and Service Certificates<a class="headerlink" href="#host-and-service-certificates" title="Permanent link">&para;</a></h1>
<p>Host and service certificates are used to securely identify your system and to
establish encrypted connections between services and clients in the OSG. Host
certificates can be used by any service running on your system. In contrast,
service certificates are used to identify specific services on your machine. For
example, HTCondor-CE typically uses a host certificate while RSV, Gratia,
Tomcat, and Apache httpd use service certificates. Technically, the primary
difference between a host certificate and service certificate is in the common
name (CN) field of the certificate.  A host certificate's CN contains the
hostname (e.g.  mymachine.mydomain.edu) while a service certificate will prepend
a service name to the hostname (e.g. http/mymachine.mydomain.edu for an Apache
httpd service certificate).</p>
<p>After reading this document you should be able to apply for and install a host
or service certificate on a grid resource.  This document does not explain how
to apply for a grid user certificate. To learn how to apply for a grid user
certificate click <a href="../user-certs/">here</a> instead!</p>
<h2 id="before-starting">Before Starting<a class="headerlink" href="#before-starting" title="Permanent link">&para;</a></h2>
<p>Before requesting a new host or service certificate, you should use <strong>openssl</strong> to 
check if you have a valid certificate already. If so, you may
safely skip this document:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> openssl x509 -in /etc/grid-security/hostcert.pem -subject -issuer -dates -noout
<span class="go">subject= /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=host.opensciencegrid.org</span>
<span class="go">issuer=/DC=org/DC=cilogon/C=US/O=CILogon/CN=CILogon OSG CA 1</span>
<span class="go">notBefore=Jan  4 21:08:09 2010 GMT</span>
<span class="go">notAfter=Jan  4 21:08:09 2011 GMT</span>
</pre></div>


<h2 id="requesting-hostservice-certificates-using-the-command-line">Requesting Host/Service Certificates Using the Command Line<a class="headerlink" href="#requesting-hostservice-certificates-using-the-command-line" title="Permanent link">&para;</a></h2>
<p>The OSG PKI Command Line Clients are tested to work on Python version 2.4+. They
have not been tested on Python version 3. In order to proceed you will also
need:</p>
<ul>
<li>an X.509 user certificate</li>
<li>Grid Admin privileges</li>
</ul>
<p>As with all OSG software installations, there are some one-time (per host) steps to prepare in advance:</p>
<ul>
<li>Ensure the host has <a href="../../release/supported_platforms">a supported operating system</a></li>
<li>Obtain root access to the host</li>
<li>Prepare the <a href="../../common/yum">required Yum repositories</a></li>
<li>Install <a href="../../common/ca">CA certificates</a></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you would like to request a host or service certificate without obtaining
Grid Admin privileges, see <a href="#requesting-hostservice-certificate-using-oim">this</a> section. </p>
</div>
<h3 id="requesting-grid-admin-privileges">Requesting Grid Admin privileges<a class="headerlink" href="#requesting-grid-admin-privileges" title="Permanent link">&para;</a></h3>
<p>A Grid Admin is a person associated with a Virtual Organization (VO) that has
been given privileges to automatically approve host certificate requests for a
given domain and any sub-domain.  For example, a Grid Admin for the <code>uchicago.edu</code>
domain would be able to approve host or service certificate requests for
<code>myhost.uchicago.edu</code>, <code>gums.grid.uchicago.edu</code>,
<code>myhost2.subdomain.uchicago.edu</code>, etc.</p>
<p>If you do not have Grid Admin privileges, you can request them
<a href="https://oim.opensciencegrid.org/oim/gridadmin">here</a> after obtaining
your <a href="../user-certs">user certificate</a>.</p>
<h3 id="installing-the-osg-pki-command-line-client">Installing the OSG PKI command line client<a class="headerlink" href="#installing-the-osg-pki-command-line-client" title="Permanent link">&para;</a></h3>
<p>The scripts needed to request host or service certificates are contained in the
<code>osg-pki-tools</code> RPM.  Install it by running the following:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> yum install osg-pki-tools
</pre></div>


<p>Please refer to <a href="../../security/certificate-management#osg-pki-command-line-clients">this
documentation</a>
for full documentation of the osg-pki-tools.</p>
<h3 id="validating-your-x509-user-certificate">Validating your X.509 user certificate<a class="headerlink" href="#validating-your-x509-user-certificate" title="Permanent link">&para;</a></h3>
<p>Make sure you can create a valid grid proxy with <code>voms-proxy-init</code> or <code>grid-proxy-init</code>. For example :</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> voms-proxy-init 
<span class="go">Enter GRID pass phrase for this identity:</span>
<span class="go">Your identity: /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services=People/CN=Alain Roy 424511</span>
<span class="go">Creating temporary proxy ................................................................................. Done</span>
<span class="go">Contacting  glow-voms.cs.wisc.edu:15001 [/DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=glow-voms.cs.wisc.edu] &quot;GLOW&quot; Done</span>
<span class="go">Creating proxy ..................................................................... Done</span>

<span class="go">Your proxy is valid until Fri Dec  2 01:32:47 2011</span>
</pre></div>


<h4 id="requesting-host-certificates">Requesting host certificates<a class="headerlink" href="#requesting-host-certificates" title="Permanent link">&para;</a></h4>
<p>The <strong>osg-gridadmin-cert-request</strong> script only supports requesting host
certificates that are in the same domain.  The certificates are stored with the
format of <code>&lt;hostname&gt;.pem</code> and the corresponding key is stored as
<code>&lt;hostname&gt;-key.pem</code>. For example:</p>
<ul>
<li>
<p>To request a host certificate for <code>host.opensciencegrid.org</code>:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> osg-gridadmin-cert-request -H host.opensciencegrid.org
</pre></div>


</li>
<li>
<p>To request a host certificate for <code>host.opensciencegrid.org</code> with Subject
  Alternative Names (SANs), use the <code>-a</code> flag for each SAN:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> osg-gridadmin-cert-request -H host.opensciencegrid.org -a host1.opensciencegrid.org -a host2.opensciencegrid.org
</pre></div>


</li>
<li>
<p>To request more than one host certificate, you can provide a file with one
  host per line and optional SANs separated with spaces. The following example
  would request three certificates; one for <code>host1.opensciencegrid.org</code>, one for
  <code>host2.opensciencegrid.org</code>, and one for <code>host.opensciencegrid.org</code> with the
  SANs <code>host1.opensciencegrid.org</code> and <code>host2.opensciencegrid.org</code>:</p>
<div class="codehilite"><pre><span></span>host1.opensciencegrid.org
host2.opensciencegrid.org
host.opensciencegrid.org host1.opensciencegrid.org host2.opensciencegrid.org
</pre></div>


<p>If the above contents were saved to <code>hostfile</code>, run the following command to request multiple certificates:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> osg-gridadmin-cert-request -f hostfile
</pre></div>


</li>
</ul>
<h4 id="installing-host-certificates">Installing host certificates<a class="headerlink" href="#installing-host-certificates" title="Permanent link">&para;</a></h4>
<p>Finally, install the certificate in the default location <code>/etc/grid-security/</code>:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> cp ./host.opensciencegrid.org.pem /etc/grid-security/hostcert.pem
<span class="gp">root@host #</span> chmod <span class="m">444</span> /etc/grid-security/hostcert.pem
<span class="gp">root@host #</span> cp ./host.opensciencegrid.org-key.pem /etc/grid-security/hostkey.pem
<span class="gp">root@host #</span> chmod <span class="m">400</span> /etc/grid-security/hostkey.pem
</pre></div>


<h3 id="requesting-and-installing-a-service-certificate">Requesting and installing a service certificate<a class="headerlink" href="#requesting-and-installing-a-service-certificate" title="Permanent link">&para;</a></h3>
<h4 id="requesting-service-certificates">Requesting service certificates<a class="headerlink" href="#requesting-service-certificates" title="Permanent link">&para;</a></h4>
<p>To request a service certificate, use the same <strong>osg-gridadmin-cert-request</strong>
that is used to request host certificates but prepend <code>&lt;service&gt;/</code> to the
requested hostname:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@host $</span> osg-gridadmin-cert-request -H http/host.opensciencegrid.org 
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All methods for <a href="#requesting-host-certificates">requesting host certificates</a> can also be used to request service certificates</p>
</div>
<h4 id="installing-service-certificates">Installing service certificates<a class="headerlink" href="#installing-service-certificates" title="Permanent link">&para;</a></h4>
<p><strong>Service certificates</strong> should be installed under a sub-directory in
<code>/etc/grid-security/</code> indicating the name of the service. For example, the
service certificate for an Apache httpd service should be installed in
<code>/etc/grid-security/http</code>:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> cp ./http-host.opensciencegrid.org.pem /etc/grid-security/http/httpcert.pem
<span class="gp">root@host #</span> chmod <span class="m">444</span> /etc/grid-security/http/httpcert.pem
<span class="gp">root@host #</span> cp ./http-host.opensciencegrid.org-key.pem /etc/grid-security/http/httpkey.pem
<span class="gp">root@host #</span> chmod <span class="m">400</span> /etc/grid-security/http/httpkey.pem
</pre></div>


<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please note that the service certificate must also be owned by the Unix user who runs the service. For <strong>Apache/Tomcat</strong> this is the tomcat user:</p>
</div>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> chown tomcat.tomcat /etc/grid-security/http/httpcert.pem
<span class="gp">root@host #</span> chown tomcat.tomcat /etc/grid-security/http/httpkey.pem
</pre></div>


<h2 id="requesting-hostservice-certificate-using-oim">Requesting Host/Service Certificate Using OIM<a class="headerlink" href="#requesting-hostservice-certificate-using-oim" title="Permanent link">&para;</a></h2>
<p>If you do not have Grid Admin privileges, please use OIM to request any host or
service certificates that you may need.  The OSG PKI Certificate Request &amp;
Management System can be found at:
<a href="https://oim.opensciencegrid.org/oim/certificate">https://oim.opensciencegrid.org/oim/certificate</a>. Alternatively, you can request
Grid Admin privileges <a href="https://oim.opensciencegrid.org/oim/gridadmin">here</a> after obtaining
your <a href="../user-certs">user certificate</a>.</p>
<p>For instructions on how to request a host or service certificate using the Web
interface please see the <a href="https://confluence.grid.iu.edu/pages/viewpage.action?pageId=3244064">user guide maintained by
the OIM development team</a>.</p>
<h2 id="frequently-asked-questions">Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permanent link">&para;</a></h2>
<h3 id="can-i-use-any-host-to-request-a-certificate-for-a-different-host">Can I use any host to request a certificate for a different host?<a class="headerlink" href="#can-i-use-any-host-to-request-a-certificate-for-a-different-host" title="Permanent link">&para;</a></h3>
<p>YES, you can use any host to create a certificate request as long as the hostname for the certificate is a fully qualified domain name.</p>
<h3 id="may-i-reuse-my-host-certificate-as-a-service-certificate">May I reuse my host certificate as a service certificate?<a class="headerlink" href="#may-i-reuse-my-host-certificate-as-a-service-certificate" title="Permanent link">&para;</a></h3>
<p>NO! For security reasons, please do not use clones of your host certificate for additional certificates even though it's technically possible.</p>
<h3 id="how-do-i-renew-a-hostservice-certificate">How do I renew a host/service certificate?<a class="headerlink" href="#how-do-i-renew-a-hostservice-certificate" title="Permanent link">&para;</a></h3>
<p>There is no separate procedure. Simply ask for a new certificate the same way you asked for it the previous time.</p>
<h3 id="i-get-a-gss-authentication-failure-when-users-try-to-authenticate-with-my-site">I get a "GSS authentication failure" when users try to authenticate with my site?<a class="headerlink" href="#i-get-a-gss-authentication-failure-when-users-try-to-authenticate-with-my-site" title="Permanent link">&para;</a></h3>
<p>You likely used an <strong>alias</strong> for the host instead of the fully qualified domain
name when you generated the certificate request. This can cause the GSS
authentication failures similar to the following when a user tries to
authenticate to the host after your certificate is installed:</p>
<div class="codehilite"><pre><span></span><span class="go">GSS authentication failure </span>
<span class="go">GSS Major Status: General failure </span>
<span class="go">GSS Minor Status Error Chain: </span>
<span class="go">accept_sec_context.c:gss_accept_sec_context:403: </span>
<span class="go">Error during delegation: Delegation protocol violation </span>
<span class="go">Failure: GSS failed Major:000d0000 Minor:00000001 Token:00000000 </span>
</pre></div>


<h3 id="how-can-i-check-if-i-have-a-host-certificate-installed-already">How can I check if I have a host certificate installed already?<a class="headerlink" href="#how-can-i-check-if-i-have-a-host-certificate-installed-already" title="Permanent link">&para;</a></h3>
<p>By default the host certificate key pair will be installed in
<code>/etc/grid-security/hostcert.pem</code> and <code>/etc/grid-security/hostkey.pem</code>. You can
use <strong>openssl</strong> to access basic information about the certificate:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> openssl x509 -in /etc/grid-security/hostcert.pem -subject -issuer -dates -noout
<span class="go">subject= /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=host.opensciencegrid.org</span>
<span class="go">issuer= /DC=org/DC=cilogon/C=US/O=CILogon/CN=CILogon OSG CA 1</span>
<span class="go">notBefore=Apr  8 00:00:00 2013 GMT</span>
<span class="go">notAfter=May 17 12:00:00 2014 GMT</span>
</pre></div>


<h3 id="how-can-i-check-the-expiration-time-of-my-installed-host-certificate">How can I check the expiration time of my installed host certificate?<a class="headerlink" href="#how-can-i-check-the-expiration-time-of-my-installed-host-certificate" title="Permanent link">&para;</a></h3>
<p>If you installed the Certificates Script Package you can use <strong>grid-cert-info</strong>
to retrieve information about the certificate:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> grid-cert-info -file /etc/grid-security/hostcert.pem -startdate -enddate
<span class="go">Jan  4 21:08:41 2010 GMT</span>
<span class="go">Jan  4 21:08:41 2011 GMT</span>
</pre></div>


<p>Alternatively you can use <strong>openssl</strong>:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> openssl x509 -in /etc/grid-security/hostcert.pem -dates -noout
<span class="go">notBefore=Jan  4 21:08:41 2010 GMT</span>
<span class="go">notAfter=Jan  4 21:08:41 2011 GMT</span>
</pre></div>


<h3 id="how-can-i-change-the-urls-queried-by-the-pki-clients">How can I change the URLs queried by the PKI clients?<a class="headerlink" href="#how-can-i-change-the-urls-queried-by-the-pki-clients" title="Permanent link">&para;</a></h3>
<p>This configuration should not need to be changed for the vast majority of uses.
The information is provided in case you need it for debugging purposes.</p>
<p>The client checks for <code>pki-clients.ini</code> file at three location in order:</p>
<ul>
<li><code>$HOME/.osg-pki/OSG_PKI.ini</code></li>
<li><code>./pki-clients.ini</code></li>
<li><code>/etc/osg/pki-clients.ini</code> (default location)</li>
</ul>
<p>The INI file contains the following information:</p>
<ul>
<li>Request URL</li>
<li>Approve URL</li>
<li>Retrieve URL</li>
<li>Host URL</li>
</ul>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="http://security.ncsa.illinois.edu/research/grid-howtos/usefulopenssl.html">Useful OpenSSL commands (from NCSA)</a> - e.g. how to convert the format of your certificate.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../user-certs/" class="btn btn-neutral float-right" title="User Certificates">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../lcmaps-voms-authentication/" class="btn btn-neutral" title="LCMAPS-VOMS authentication"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opensciencegrid/docs-itb/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../lcmaps-voms-authentication/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../user-certs/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
