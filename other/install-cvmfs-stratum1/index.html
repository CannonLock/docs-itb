



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://opensciencegrid.github.io/docs-itb/other/install-cvmfs-stratum1/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.1, mkdocs-material-2.5.5">
    
    
      
        <title>Install a CVMFS Stratum 1 - OSG Documentation (ITB)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.aa3de92b.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/itb.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#install-a-cvmfs-stratum-1" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://opensciencegrid.github.io/docs-itb/" title="OSG Documentation (ITB)" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                OSG Documentation (ITB)
              </span>
              <span class="md-header-nav__topic">
                Install a CVMFS Stratum 1
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/opensciencegrid/docs-itb/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    OSG Documentation (ITB)
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/opensciencegrid/docs-itb/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../site-planning/" title="Site Planning" class="md-nav__link">
      Site Planning
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Compute Element
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Compute Element
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../compute-element/htcondor-ce-overview/" title="HTCondor-CE Overview" class="md-nav__link">
      HTCondor-CE Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../compute-element/install-htcondor-ce/" title="Install HTCondor-CE" class="md-nav__link">
      Install HTCondor-CE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../compute-element/job-router-recipes/" title="Job Router Recipes" class="md-nav__link">
      Job Router Recipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../compute-element/troubleshoot-htcondor-ce/" title="Troubleshooting HTCondor-CE" class="md-nav__link">
      Troubleshooting HTCondor-CE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../compute-element/submit-htcondor-ce/" title="Submitting to HTCondor-CE" class="md-nav__link">
      Submitting to HTCondor-CE
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Worker Node
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Worker Node
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../worker-node/using-wn/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../worker-node/install-wn/" title="Install from RPM" class="md-nav__link">
      Install from RPM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../worker-node/install-wn-tarball/" title="Install from Tarball" class="md-nav__link">
      Install from Tarball
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../worker-node/install-wn-oasis/" title="Install from OASIS" class="md-nav__link">
      Install from OASIS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../worker-node/install-cvmfs/" title="Install CVMFS" class="md-nav__link">
      Install CVMFS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../worker-node/install-singularity/" title="Install Singularity" class="md-nav__link">
      Install Singularity
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      HTTP & CVMFS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        HTTP & CVMFS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/frontier-squid/" title="Install HTTP Cache" class="md-nav__link">
      Install HTTP Cache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/update-oasis/" title="Update OASIS Shared Repo" class="md-nav__link">
      Update OASIS Shared Repo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/external-oasis-repos/" title="Install an OASIS Repo" class="md-nav__link">
      Install an OASIS Repo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      POSIX Storage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        POSIX Storage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/gridftp/" title="Install GridFTP Server" class="md-nav__link">
      Install GridFTP Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/load-balanced-gridftp/" title="Install Load Balanced GridFTP" class="md-nav__link">
      Install Load Balanced GridFTP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3">
    
    <label class="md-nav__link" for="nav-5-3">
      HDFS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        HDFS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/hadoop-overview/" title="HDFS Overview" class="md-nav__link">
      HDFS Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/install-hadoop-2-0-0/" title="Install HDFS" class="md-nav__link">
      Install HDFS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4">
    
    <label class="md-nav__link" for="nav-5-4">
      XRootD
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        XRootD
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/xrootd-overview/" title="XRootD Overview" class="md-nav__link">
      XRootD Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/install-xrootd/" title="Install XRootD" class="md-nav__link">
      Install XRootD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/install-xroot-client/" title="Install XRootD Client" class="md-nav__link">
      Install XRootD Client
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Security
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Security
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/lcmaps-voms-authentication/" title="LCMAPS-VOMS authentication" class="md-nav__link">
      LCMAPS-VOMS authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/host-certs/" title="Host and Service Certificates" class="md-nav__link">
      Host and Service Certificates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/user-certs/" title="User Certificates" class="md-nav__link">
      User Certificates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/certificate-management/" title="Certificate Management Reference" class="md-nav__link">
      Certificate Management Reference
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Common
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Common
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../common/install-best-practices/" title="Install Best Practices" class="md-nav__link">
      Install Best Practices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../common/ca/" title="CA Certificates" class="md-nav__link">
      CA Certificates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../common/yum/" title="Yum Repos" class="md-nav__link">
      Yum Repos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../common/openjdk7/" title="Java 7" class="md-nav__link">
      Java 7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configuration-with-osg-configure/" title="Configuration with OSG-Configure" class="md-nav__link">
      Configuration with OSG-Configure
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      Other
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gsissh/" title="Install GSI-enabled SSH" class="md-nav__link">
      Install GSI-enabled SSH
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-gwms-frontend/" title="Install GlideinWMS Frontend" class="md-nav__link">
      Install GlideinWMS Frontend
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Install a CVMFS Stratum 1
      </label>
    
    <a href="./" title="Install a CVMFS Stratum 1" class="md-nav__link md-nav__link--active">
      Install a CVMFS Stratum 1
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-starting" title="Before Starting" class="md-nav__link">
    Before Starting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing" title="Installing" class="md-nav__link">
    Installing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-cvmfs-server-and-httpd" title="Installing cvmfs-server and httpd" class="md-nav__link">
    Installing cvmfs-server and httpd
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-a-cvmfs-stratum-1-that-is-also-a-repository-server" title="Installing a CVMFS stratum 1 that is also a repository server" class="md-nav__link">
    Installing a CVMFS stratum 1 that is also a repository server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-cvmfs-stratum-1-that-is-not-a-repository-server" title="Installing CVMFS stratum 1 that is not a repository server" class="md-nav__link">
    Installing CVMFS stratum 1 that is not a repository server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-frontier-squid-and-frontier-awstats" title="Installing frontier-squid and frontier-awstats" class="md-nav__link">
    Installing frontier-squid and frontier-awstats
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring" title="Configuring" class="md-nav__link">
    Configuring
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-the-system" title="Configuring the system" class="md-nav__link">
    Configuring the system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-cron" title="Configuring cron" class="md-nav__link">
    Configuring cron
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-apache" title="Configuring apache" class="md-nav__link">
    Configuring apache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-frontier-squid" title="Configuring frontier-squid" class="md-nav__link">
    Configuring frontier-squid
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifying" title="Verifying" class="md-nav__link">
    Verifying
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-an-example-repository" title="Adding an example repository" class="md-nav__link">
    Adding an example repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-that-the-replica-is-being-served" title="Verifying that the replica is being served" class="md-nav__link">
    Verifying that the replica is being served
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-monitoring" title="Setting up monitoring" class="md-nav__link">
    Setting up monitoring
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../network-performance-toolkit/" title="Install the Network Performance Toolkit" class="md-nav__link">
      Install the Network Performance Toolkit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting-gratia/" title="Troubleshooting Gratia" class="md-nav__link">
      Troubleshooting Gratia
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../schedd-filebeats/" title="Install Transfer Log Filebeats" class="md-nav__link">
      Install Transfer Log Filebeats
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Release Information
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Release Information
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/notes/" title="Release Note Overview" class="md-nav__link">
      Release Note Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      3.4 Release Notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        3.4 Release Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-6-2/" title="OSG Release 3.4.6-2" class="md-nav__link">
      OSG Release 3.4.6-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-6/" title="OSG Release 3.4.6" class="md-nav__link">
      OSG Release 3.4.6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-5-4/" title="OSG Release 3.4.5-4" class="md-nav__link">
      OSG Release 3.4.5-4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-5-3/" title="OSG Release 3.4.5-3" class="md-nav__link">
      OSG Release 3.4.5-3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-5-2/" title="OSG Release 3.4.5-2" class="md-nav__link">
      OSG Release 3.4.5-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-5/" title="OSG Release 3.4.5" class="md-nav__link">
      OSG Release 3.4.5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-4-3/" title="OSG Release 3.4.4-3" class="md-nav__link">
      OSG Release 3.4.4-3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-4-2/" title="OSG Release 3.4.4-2" class="md-nav__link">
      OSG Release 3.4.4-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-4/" title="OSG Release 3.4.4" class="md-nav__link">
      OSG Release 3.4.4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-3/" title="OSG Release 3.4.3" class="md-nav__link">
      OSG Release 3.4.3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-2-2/" title="OSG Release 3.4.2-2" class="md-nav__link">
      OSG Release 3.4.2-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-2/" title="OSG Release 3.4.2" class="md-nav__link">
      OSG Release 3.4.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-1-2/" title="OSG Release 3.4.1-2" class="md-nav__link">
      OSG Release 3.4.1-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-1/" title="OSG Release 3.4.1" class="md-nav__link">
      OSG Release 3.4.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-0-2/" title="OSG Release 3.4.0-2" class="md-nav__link">
      OSG Release 3.4.0-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.4/release-3-4-0/" title="OSG Release 3.4.0" class="md-nav__link">
      OSG Release 3.4.0
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-3" type="checkbox" id="nav-9-3">
    
    <label class="md-nav__link" for="nav-9-3">
      3.3 Release Notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-3">
        3.3 Release Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-31-2/" title="OSG Release 3.3.31-2" class="md-nav__link">
      OSG Release 3.3.31-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-31/" title="OSG Release 3.3.31" class="md-nav__link">
      OSG Release 3.3.31
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-30-4/" title="OSG Release 3.3.30-4" class="md-nav__link">
      OSG Release 3.3.30-4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-30-3/" title="OSG Release 3.3.30-3" class="md-nav__link">
      OSG Release 3.3.30-3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-30-2/" title="OSG Release 3.3.30-2" class="md-nav__link">
      OSG Release 3.3.30-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-30/" title="OSG Release 3.3.30" class="md-nav__link">
      OSG Release 3.3.30
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-29-3/" title="OSG Release 3.3.29-3" class="md-nav__link">
      OSG Release 3.3.29-3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-29-2/" title="OSG Release 3.3.29-2" class="md-nav__link">
      OSG Release 3.3.29-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-29/" title="OSG Release 3.3.29" class="md-nav__link">
      OSG Release 3.3.29
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-28/" title="OSG Release 3.3.28" class="md-nav__link">
      OSG Release 3.3.28
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-27-2/" title="OSG Release 3.3.27-2" class="md-nav__link">
      OSG Release 3.3.27-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-27/" title="OSG Release 3.3.27" class="md-nav__link">
      OSG Release 3.3.27
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-26-2/" title="OSG Release 3.3.26-2" class="md-nav__link">
      OSG Release 3.3.26-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-26/" title="OSG Release 3.3.26" class="md-nav__link">
      OSG Release 3.3.26
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-25-2/" title="OSG Release 3.3.25-2" class="md-nav__link">
      OSG Release 3.3.25-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-25/" title="OSG Release 3.3.25" class="md-nav__link">
      OSG Release 3.3.25
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-24-2/" title="OSG Release 3.3.24-2" class="md-nav__link">
      OSG Release 3.3.24-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-24/" title="OSG Release 3.3.24" class="md-nav__link">
      OSG Release 3.3.24
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-23/" title="OSG Release 3.3.23" class="md-nav__link">
      OSG Release 3.3.23
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-22-3/" title="OSG Release 3.3.22-3" class="md-nav__link">
      OSG Release 3.3.22-3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-22-2/" title="OSG Release 3.3.22-2" class="md-nav__link">
      OSG Release 3.3.22-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-22/" title="OSG Release 3.3.22" class="md-nav__link">
      OSG Release 3.3.22
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-21-3/" title="OSG Release 3.3.21-3" class="md-nav__link">
      OSG Release 3.3.21-3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-21-2/" title="OSG Release 3.3.21-2" class="md-nav__link">
      OSG Release 3.3.21-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-21/" title="OSG Release 3.3.21" class="md-nav__link">
      OSG Release 3.3.21
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-20-2/" title="OSG Release 3.3.20-2" class="md-nav__link">
      OSG Release 3.3.20-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-20/" title="OSG Release 3.3.20" class="md-nav__link">
      OSG Release 3.3.20
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-19/" title="OSG Release 3.3.19" class="md-nav__link">
      OSG Release 3.3.19
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-18/" title="OSG Release 3.3.18" class="md-nav__link">
      OSG Release 3.3.18
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-17-2/" title="OSG Release 3.3.17-2" class="md-nav__link">
      OSG Release 3.3.17-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-17/" title="OSG Release 3.3.17" class="md-nav__link">
      OSG Release 3.3.17
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-16/" title="OSG Release 3.3.16" class="md-nav__link">
      OSG Release 3.3.16
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-15/" title="OSG Release 3.3.15" class="md-nav__link">
      OSG Release 3.3.15
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-14/" title="OSG Release 3.3.14" class="md-nav__link">
      OSG Release 3.3.14
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-13/" title="OSG Release 3.3.13" class="md-nav__link">
      OSG Release 3.3.13
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-12/" title="OSG Release 3.3.12" class="md-nav__link">
      OSG Release 3.3.12
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-11/" title="OSG Release 3.3.11" class="md-nav__link">
      OSG Release 3.3.11
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-10/" title="OSG Release 3.3.10" class="md-nav__link">
      OSG Release 3.3.10
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-9/" title="OSG Release 3.3.9" class="md-nav__link">
      OSG Release 3.3.9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-8/" title="OSG Release 3.3.8" class="md-nav__link">
      OSG Release 3.3.8
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-7/" title="OSG Release 3.3.7" class="md-nav__link">
      OSG Release 3.3.7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-6/" title="OSG Release 3.3.6" class="md-nav__link">
      OSG Release 3.3.6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-5/" title="OSG Release 3.3.5" class="md-nav__link">
      OSG Release 3.3.5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-4/" title="OSG Release 3.3.4" class="md-nav__link">
      OSG Release 3.3.4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-3/" title="OSG Release 3.3.3" class="md-nav__link">
      OSG Release 3.3.3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-2/" title="OSG Release 3.3.2" class="md-nav__link">
      OSG Release 3.3.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-1/" title="OSG Release 3.3.1" class="md-nav__link">
      OSG Release 3.3.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/3.3/release-3-3-0/" title="OSG Release 3.3.0" class="md-nav__link">
      OSG Release 3.3.0
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/release_series/" title="OSG Release Series" class="md-nav__link">
      OSG Release Series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/supported_platforms/" title="Supported Platforms" class="md-nav__link">
      Supported Platforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-osg-upcoming-software/" title="OSG upcoming software" class="md-nav__link">
      OSG upcoming software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/yum-basics/" title="Yum Basics" class="md-nav__link">
      Yum Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/signing/" title="RPM Signing" class="md-nav__link">
      RPM Signing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/contrib/" title="Contrib Software" class="md-nav__link">
      Contrib Software
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Monitoring
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Monitoring
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitoring/install-rsv/" title="Install RSV" class="md-nav__link">
      Install RSV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitoring/advanced-rsv-configuration/" title="Advanced RSV Configuration" class="md-nav__link">
      Advanced RSV Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitoring/rsv-control/" title="Manage RSV via rsv-control" class="md-nav__link">
      Manage RSV via rsv-control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../monitoring/install-rsv-gwms-tester/" title="RSV GlideinWMS Tester" class="md-nav__link">
      RSV GlideinWMS Tester
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Deprecated Software
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Deprecated Software
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/bestman-install/" title="Install BeStMan" class="md-nav__link">
      Install BeStMan
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/install-bestman-xrootd/" title="Install BeStMan Xrootd SE" class="md-nav__link">
      Install BeStMan Xrootd SE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/edg-mkgridmap/" title="Install EDG-Mkgridmap" class="md-nav__link">
      Install EDG-Mkgridmap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/install-gums/" title="Install GUMS" class="md-nav__link">
      Install GUMS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../worker-node/install-glexec/" title="Install Worker node glexec" class="md-nav__link">
      Install Worker node glexec
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-voms/" title="Install VOMS" class="md-nav__link">
      Install VOMS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../common/help/" title="Get Help" class="md-nav__link">
      Get Help
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-starting" title="Before Starting" class="md-nav__link">
    Before Starting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing" title="Installing" class="md-nav__link">
    Installing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-cvmfs-server-and-httpd" title="Installing cvmfs-server and httpd" class="md-nav__link">
    Installing cvmfs-server and httpd
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-a-cvmfs-stratum-1-that-is-also-a-repository-server" title="Installing a CVMFS stratum 1 that is also a repository server" class="md-nav__link">
    Installing a CVMFS stratum 1 that is also a repository server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-cvmfs-stratum-1-that-is-not-a-repository-server" title="Installing CVMFS stratum 1 that is not a repository server" class="md-nav__link">
    Installing CVMFS stratum 1 that is not a repository server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-frontier-squid-and-frontier-awstats" title="Installing frontier-squid and frontier-awstats" class="md-nav__link">
    Installing frontier-squid and frontier-awstats
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring" title="Configuring" class="md-nav__link">
    Configuring
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-the-system" title="Configuring the system" class="md-nav__link">
    Configuring the system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-cron" title="Configuring cron" class="md-nav__link">
    Configuring cron
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-apache" title="Configuring apache" class="md-nav__link">
    Configuring apache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-frontier-squid" title="Configuring frontier-squid" class="md-nav__link">
    Configuring frontier-squid
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifying" title="Verifying" class="md-nav__link">
    Verifying
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-an-example-repository" title="Adding an example repository" class="md-nav__link">
    Adding an example repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-that-the-replica-is-being-served" title="Verifying that the replica is being served" class="md-nav__link">
    Verifying that the replica is being served
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-monitoring" title="Setting up monitoring" class="md-nav__link">
    Setting up monitoring
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/opensciencegrid/docs-itb/edit/master/docs/other/install-cvmfs-stratum1.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="install-a-cvmfs-stratum-1">Install a CVMFS Stratum 1<a class="headerlink" href="#install-a-cvmfs-stratum-1" title="Permanent link">&para;</a></h1>
<p>This document describes how to install a CVMFS Stratum 1. There are many different variations on how to do that, but this document focuses on the configuration of the OSG GOC Stratum 1 oasis-replica.opensciencegrid.org. It is applicable to other Stratum 1s as well, very likely with modifications (some of which are suggested in the document below).</p>
<div class="admonition note">
<p class="admonition-title">Applicable versions</p>
<p>The applicable software versions for this document are cvmfs and cvmfs-server &gt;= 2.4.2.</p>
</div>
<h2 id="before-starting">Before Starting<a class="headerlink" href="#before-starting" title="Permanent link">&para;</a></h2>
<p>Before starting the installation process, consider the following points:</p>
<ul>
<li><strong>User IDs and Group IDs:</strong> If your machine is also going to be a repository server like the OSG GOC, the installation will create the same user and group IDs as the <a href="../../worker-node/install-cvmfs">cvmfs client</a>.  If you are installing frontier-squid, the installation will also create the same user id as <a href="../../data/frontier-squid">frontier-squid</a>.</li>
<li><strong>Network ports:</strong> This installation will host the stratum 1 on ports 80 and 8000 and, if squid is installed, it will host the uncached apache on port 8080.</li>
<li><strong>Host choice:</strong> -  Make sure there is adequate disk space for the repositories that will be served, at <code>/srv/cvmfs</code>. Do not use xfs as the filesystem type on operating systems older than EL7, because it has been demonstrated to perform poorly for CVMFS repositories; instead use ext3 or ext4. About 10GB should be reserved for apache and squid logs under /var/log on a production server, although they normally will not get that large. A Stratum 1 that is also a repository server should have at least 5GB available at <code>/var/cache</code>.</li>
<li><strong>SELinux</strong> - Ensure SELinux is disabled</li>
</ul>
<p>As with all OSG software installations, there are some one-time (per host) steps to prepare in advance:</p>
<ul>
<li>Ensure the host has <a href="../../release/supported_platforms">a supported operating system</a></li>
<li>Obtain root access to the host</li>
<li>Prepare the <a href="../../common/yum">required Yum repositories</a></li>
</ul>
<h2 id="installing">Installing<a class="headerlink" href="#installing" title="Permanent link">&para;</a></h2>
<p>All CVMFS Stratum 1s require cvmfs-server software and apache (httpd). It is highly recommended to also install <a href="../../data/frontier-squid">frontier-squid</a> and <a href="https://twiki.cern.ch/twiki/bin/view/Frontier/InstallAwstats">frontier-awstats</a> on the same machine to be able to easily join the WLCG <a href="http://wlcg-squid-monitor.cern.ch/snmpstats/indexcvmfs.html">MRTG</a> and <a href="http://wlcg-squid-monitor.cern.ch/awstats/cvmfs.html">awstats</a> monitoring systems. The recommended configuration for frontier-squid below only caches geo api lookups.  Other than that, it is primarily for monitoring.</p>
<h3 id="installing-cvmfs-server-and-httpd">Installing cvmfs-server and httpd<a class="headerlink" href="#installing-cvmfs-server-and-httpd" title="Permanent link">&para;</a></h3>
<p>The OSG GOC Stratum 1 has to function as a repository server in addition to serving repository replications; most Stratum 1s serve only replications. Instructions are also provided for how to install cvmfs-server on Stratum 1s that do not have to be repository servers.  Choose the appropriate subsection.</p>
<h4 id="installing-a-cvmfs-stratum-1-that-is-also-a-repository-server">Installing a CVMFS stratum 1 that is also a repository server<a class="headerlink" href="#installing-a-cvmfs-stratum-1-that-is-also-a-repository-server" title="Permanent link">&para;</a></h4>
<p>EL6 does not support a CVMFS repository server with the standard kernel, so use EL7.  EL7.2 cannot be reliably used as a repository server, because of bugs in the union filesystem OverlayFS. The bugs are fixed in EL7.3, so use EL7.3 or later.</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> yum -y install cvmfs-server cvmfs mod_wsgi
</pre></div>


<h4 id="installing-cvmfs-stratum-1-that-is-not-a-repository-server">Installing CVMFS stratum 1 that is not a repository server<a class="headerlink" href="#installing-cvmfs-stratum-1-that-is-not-a-repository-server" title="Permanent link">&para;</a></h4>
<p>If you're not installing for the OSG GOC or otherwise want to support serving repositories on the same machine as a Stratum 1, use this command on either EL6 or EL7:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> yum -y install cvmfs-server cvmfs-config mod_wsgi
</pre></div>


<h3 id="installing-frontier-squid-and-frontier-awstats">Installing frontier-squid and frontier-awstats<a class="headerlink" href="#installing-frontier-squid-and-frontier-awstats" title="Permanent link">&para;</a></h3>
<p><a href="https://twiki.cern.ch/twiki/bin/view/Frontier/InstallAwstats">frontier-awstats</a> is not distributed by OSG so these instructions get it from its original source.  Do these commands to install frontier-squid and frontier-awstats:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> rpm -i http://frontier.cern.ch/dist/rpms/RPMS/noarch/frontier-release-1.1-1.noarch.rpm
<span class="gp">root@host #</span> yum -y install frontier-awstats
</pre></div>


<h2 id="configuring">Configuring<a class="headerlink" href="#configuring" title="Permanent link">&para;</a></h2>
<h3 id="configuring-the-system">Configuring the system<a class="headerlink" href="#configuring-the-system" title="Permanent link">&para;</a></h3>
<p>Increase the default number of open file descriptors:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> <span class="nb">echo</span> -e <span class="s2">&quot;*\t\t-\tnofile\t\t16384&quot;</span> &gt;&gt;/etc/security/limits.conf 
<span class="gp">root@host #</span> <span class="nb">ulimit</span> -n <span class="m">16384</span>
</pre></div>


<p>In order for this to apply also interactively when logging in over ssh, the option <code>UsePAM</code> has to be set to <code>yes</code> in <code>/etc/ssh/sshd_config</code>.</p>
<h3 id="configuring-cron">Configuring cron<a class="headerlink" href="#configuring-cron" title="Permanent link">&para;</a></h3>
<p>First, create the log directory: </p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> mkdir -p /var/log/cvmfs
</pre></div>


<p>Put the following in <code>/etc/cron.d/cvmfs</code>:</p>
<div class="codehilite"><pre><span></span>*/5 * * * * root test -d /srv/cvmfs || exit;cvmfs_server snapshot -ai 
6 1 * * * root cvmfs_server gc -af 2&gt;/dev/null || true
0 9 * * * root find /srv/cvmfs/*.*/data/txn -name &quot;*.*&quot; -mtime +2 2&gt;/dev/null|xargs rm -f
</pre></div>


<p>Also, put the following in <code>/etc/logrotate.d/cvmfs</code>:</p>
<div class="codehilite"><pre><span></span>/var/log/cvmfs/*.log {
    weekly
    missingok
    notifempty
}
</pre></div>


<h3 id="configuring-apache">Configuring apache<a class="headerlink" href="#configuring-apache" title="Permanent link">&para;</a></h3>
<p>If you are installing frontier-squid, create <code>/etc/httpd/conf.d/cvmfs.conf</code> and put the following lines into it:</p>
<div class="codehilite"><pre><span></span>Listen 8080 KeepAlive On
</pre></div>


<p>If you are not installing frontier-squid, instead put the following lines into that file:</p>
<div class="codehilite"><pre><span></span>Listen 8000 KeepAlive On
</pre></div>


<p>If you will be serving opensciencegrid.org repositories, you have to allow for old client configurations that access repositories without the domain name added. For that reason, you will need to remove each <code>/etc/httpd/conf.d/cvmfs.&lt;repositoryname&gt;.conf</code> that adding a replica creates (this is included in the <a href="https://github.com/opensciencegrid/oasis-server/blob/master/goc/bin/add_osg_repository">add_osg_repository script</a>), and instead add the following to <code>/etc/httpd/conf.d/cvmfs.conf</code>:</p>
<div class="codehilite"><pre><span></span>RewriteEngine On 
RewriteRule ^/cvmfs/([^./]*)/(.*)$ /cvmfs/$1.opensciencegrid.org/$2 
RewriteRule ^/cvmfs/([^/]+)/api/(.*)$ /var/www/wsgi-scripts/cvmfs-server/cvmfs-api.wsgi/$1/$2
RewriteRule ^/cvmfs/(.*)$ /srv/cvmfs/$1 
<span class="nt">&lt;Directory</span> <span class="err">&quot;/srv/cvmfs&quot;</span><span class="nt">&gt;</span> 
  Options -MultiViews +FollowSymLinks -Indexes 
  AllowOverride All 
  Require all granted

  EnableMMAP Off EnableSendFile Off

  <span class="nt">&lt;FilesMatch</span> <span class="err">&quot;^\.cvmfs&quot;</span><span class="nt">&gt;</span>
    ForceType application/x-cvmfs
  <span class="nt">&lt;/FilesMatch&gt;</span>

  Header unset Last-Modified 
  FileETag None

  ExpiresActive On 
  ExpiresDefault &quot;access plus 3 days&quot; 
  ExpiresByType text/html &quot;access plus 15 minutes&quot; 
  ExpiresByType application/x-cvmfs &quot;access plus 61 seconds&quot; 
  ExpiresByType application/json &quot;access plus 61 seconds&quot; 
<span class="nt">&lt;/Directory&gt;</span>

WSGIDaemonProcess cvmfs-api threads=64 display-name=%{GROUP} \
    python-path=/usr/share/cvmfs-server/webapi
<span class="nt">&lt;Directory</span> <span class="err">/var/www/wsgi-scripts/cvmfs-server</span><span class="nt">&gt;</span>
  WSGIProcessGroup cvmfs-api
  WSGIApplicationGroup cvmfs-api
  Options ExecCGI
  SetHandler wsgi-script
  Require all granted
<span class="nt">&lt;/Directory&gt;</span>
WSGISocketPrefix /var/run/wsgi 
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On EL6-based systems (Apache httpd 2.2) replace both instances of <code>Require all granted</code> above with the following:</p>
<div class="codehilite"><pre><span></span>Order allow, deny
Allow from all
</pre></div>


</div>
<p>If you will be serving cern.ch repositories, it has the same problem; replace opensciencegrid.org above with cern.ch. If you need to serve both opensciencegrid.org and cern.ch contact Dave Dykstra to discuss the options.</p>
<p>Then enable apache.  On EL6 do</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> chkconfig httpd on 
<span class="gp">root@host #</span> service httpd start
</pre></div>


<p>or on EL7 do</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> systemctl <span class="nb">enable</span> httpd
<span class="gp">root@host #</span> systemctl start httpd
</pre></div>


<h3 id="configuring-frontier-squid">Configuring frontier-squid<a class="headerlink" href="#configuring-frontier-squid" title="Permanent link">&para;</a></h3>
<p>Put the following in <code>/etc/squid/customize.sh</code> after the existing comment header:</p>
<div class="codehilite"><pre><span></span><span class="nx">awk</span> <span class="o">--</span><span class="nx">file</span> <span class="err">`</span><span class="nx">dirname</span> <span class="o">$</span><span class="mi">0</span><span class="err">`</span><span class="o">/</span><span class="nx">customhelps</span><span class="p">.</span><span class="nx">awk</span> <span class="o">--</span><span class="nx">source</span> <span class="s1">&#39;{</span>

<span class="s1"># cache only api calls </span>
<span class="s1">insertline(&quot;^http_access deny all&quot;, &quot;acl CVMFSAPI urlpath_regex ^/cvmfs/[^/]*/api/&quot;)</span>
<span class="s1">insertline(&quot;^http_access deny all&quot;, &quot;cache deny CVMFSAPI&quot;)</span>

<span class="s1"># port 80 is also supported, through an iptables redirect </span>
<span class="s1">setoption(&quot;http_port&quot;, &quot;8000 accel defaultsite=localhost:8080 no-vhost&quot;)</span>
<span class="s1">setoption(&quot;cache_peer&quot;, &quot;localhost parent 8080 0 no-query originserver&quot;)</span>

<span class="s1"># allow incoming http accesses from anywhere</span>
<span class="s1"># all requests will be forwarded to the originserver </span>
<span class="s1">commentout(&quot;http_access allow NET_LOCAL&quot;)</span>
<span class="s1">insertline(&quot;^http_access deny all&quot;, &quot;http_access allow all&quot;)</span>

<span class="s1"># do not let squid cache DNS entries more than 5 minutes </span>
<span class="s1">setoption(&quot;positive_dns_ttl&quot;, &quot;5 minutes&quot;)</span>

<span class="s1"># set shutdown_lifetime to 0 to avoid giving new connections error</span>
<span class="s1"># codes, which get cached upstream </span>
<span class="s1">setoption(&quot;shutdown_lifetime&quot;, &quot;0 seconds&quot;)</span>

<span class="s1"># turn off collapsed_forwarding to prevent slow clients from slowing down</span>
<span class="s1"># faster ones</span>
<span class="s1">setoption(&quot;collapsed_forwarding&quot;, &quot;off&quot;)</span>

<span class="s1">print</span>
<span class="s1">}&#39;</span>
</pre></div>


<p>On an EL7 system, make sure that iptables-services is installed and enabled:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> yum -y install iptables-services 
<span class="gp">root@host #</span> systemctl <span class="nb">enable</span> iptables
</pre></div>


<p>Forward port 80 to port 8000 (first command is for external, second command for localhost):</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> iptables -t nat -A PREROUTING -p tcp -m tcp --dport <span class="m">80</span> -j REDIRECT --to-ports <span class="m">8000</span> 
<span class="gp">root@host #</span> iptables -t nat -A OUTPUT -o lo -p tcp -m tcp --dport <span class="m">80</span> -j REDIRECT --to-ports <span class="m">8000</span> 
<span class="gp">root@host #</span> service iptables save
</pre></div>


<p>On EL7 also set up the the same port forwarding for IPv6 (unfortunately it is not supported on EL6):</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> ip6tables -t nat -A PREROUTING -p tcp -m tcp --dport <span class="m">80</span> -j REDIRECT --to-ports <span class="m">8000</span>
<span class="gp">root@host #</span> ip6tables -t nat -A OUTPUT -o lo -p tcp -m tcp --dport <span class="m">80</span> -j REDIRECT --to-ports <span class="m">8000</span>
<span class="gp">root@host #</span> service ip6tables save
</pre></div>


<p>Enable frontier-squid.  On EL6 do:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> chkconfig frontier-squid on
<span class="gp">root@host #</span> service frontier-squid start
</pre></div>


<p>or on EL7 do:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> systemctl <span class="nb">enable</span> frontier-squid
<span class="gp">root@host #</span> systemctl start frontier-squid
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above configuration is for a single squid thread, which is fine for 1Gbit/s and possibly 2Gbit/s, but if higher bandwidth is needed, see the <a href="https://twiki.cern.ch/twiki/bin/view/Frontier/InstallSquid#Running_multiple_squid_workers">instructions for running multiple squid workers</a>.</p>
</div>
<h2 id="verifying">Verifying<a class="headerlink" href="#verifying" title="Permanent link">&para;</a></h2>
<p>In order to verify that everything is installed correctly, create a repository replica. The repository chosen for the instructions below is one from egi.eu because it is very small, but you can use another one if you prefer.</p>
<h3 id="adding-an-example-repository">Adding an example repository<a class="headerlink" href="#adding-an-example-repository" title="Permanent link">&para;</a></h3>
<p>The OSG GOC Stratum 1 should add a repository replica using the <code>add_osg_repository</code> script from the oasis-goc rpm. Instructions for installing that are elsewhere. That script assumes that the oasis.opensciencegrid.org replica repository was first created, so this instruction creates it but does not download the first snapshot because that would take a lot of space and time. Use these commands to create the oasis replica and to create and download the example replica:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> cvmfs_server add-replica -o root http://oasis.opensciencegrid.org:8000/cvmfs/oasis.opensciencegrid.org /etc/cvmfs/keys/opensciencegrid.org/opensciencegrid.org.pub 
<span class="gp">root@host #</span> add_osg_repository http://cvmfs-stratum0.gridpp.rl.ac.uk:8000/cvmfs/config-egi.egi.eu
</pre></div>


<p>It's a good idea for other Stratum 1s to make their own scripts for adding repository replicas, because there's always two or three commands to run, and it's easy to forget the commands after the first one. The first command is this:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> cvmfs_server add-replica -o root http://cvmfs-stratum0.gridpp.rl.ac.uk:8000/cvmfs/config-egi.egi.eu /etc/cvmfs/keys/egi.eu/egi.eu.pub
</pre></div>


<p>However, non-GOC OSG Stratum 1s (that is, at BNL and FNAL), for the sake of fulfilling an OSG security requirement, need to instead read from the OSG GOC machine with this as their first command:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> cvmfs_server add-replica -o root http://oasis-replica.opensciencegrid.org:8000/cvmfs/config-egi.egi.eu /etc/cvmfs/keys/egi.eu/egi.eu.pub:/etc/cvmfs/keys/opensciencegrid.org/opensciencegrid.org.pub
</pre></div>


<p>The second command for Stratum 1s that have the httpd configuration as described above in the <a href="#configuring-apache">Configuring apache section</a> is this:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> rm -f /etc/httpd/conf.d/cvmfs.config-egi.egi.eu.conf
</pre></div>


<p>Then the next command is this:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> cvmfs_server snapshot config-egi.egi.eu
</pre></div>


<p>With large repositories that can take a very long time, but with small repositories it should be very quick and not show any errors.</p>
<h3 id="verifying-that-the-replica-is-being-served">Verifying that the replica is being served<a class="headerlink" href="#verifying-that-the-replica-is-being-served" title="Permanent link">&para;</a></h3>
<p>Now to verify that the replication is working, do the following commands:</p>
<div class="codehilite"><pre><span></span><span class="gp">root@host #</span> wget -qdO- http://localhost:8000/cvmfs/config-egi.egi.eu/.cvmfspublished <span class="p">|</span> cat -v
<span class="gp">root@host #</span> wget -qdO- http://localhost:80/cvmfs/config-egi.egi.eu/.cvmfspublished <span class="p">|</span> cat -v
</pre></div>


<p>Both commands should show a short file including gibberish at the end which is the signature.</p>
<p>It is a good idea to familiarize yourself with the log entries at <code>/var/log/httpd/access_log</code> and also, if you have installed frontier-squid, at <code>/var/log/squid/access.log</code>. Also, at least 15 minutes after the snapshot is finished, check the log <code>/var/log/cvmfs/snapshots.log</code> to see that it tried to get an update and got no errors.</p>
<h2 id="setting-up-monitoring">Setting up monitoring<a class="headerlink" href="#setting-up-monitoring" title="Permanent link">&para;</a></h2>
<p>If you installed frontier-squid and frontier-awstats, there is a little more to do to configure monitoring.</p>
<p>First, make sure that your firewall accepts UDP queries from the monitoring server at CERN. Details are in <a href="https://twiki.cern.ch/twiki/bin/view/Frontier/InstallSquid#Enabling_monitoring">the frontier-squid instructions</a>. Next, choose any random password and put it in <code>/etc/awstats/password-file</code>. Then tell Dave Dykstra the fully qualified domain name of your machine and the password you chose, and he'll set up the monitoring servers.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../install-gwms-frontend/" title="Install GlideinWMS Frontend" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Install GlideinWMS Frontend
              </span>
            </div>
          </a>
        
        
          <a href="../network-performance-toolkit/" title="Install the Network Performance Toolkit" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Install the Network Performance Toolkit
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.f041762f.js"></script>
      
      <script>app.initialize({version:"0.17.1",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>